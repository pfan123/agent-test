# Agent如何选择状态管理

作为专业的 Agent 开发人员，我为你深入解析 `langchain-cli` 提供的这五个模板。在 2026 年的生产环境下，这五个选项代表了 **Agent 的五种核心能力维度**。

```
npx @langchain/langgraph-cli new langgraph
```

以下是它们的详细对比、技术实现逻辑及选型指南：

1. New LangGraph Project (架构底座：流程编排)

- **核心定义：** 基于状态机（State Machine）的计算图架构。
- **理解：** 它不是一个具体的“功能”，而是**所有复杂 Agent 的容器**。它允许 Agent 在执行过程中进行**循环、分支、反思和人工干预**。
- **技术特征：**
  - **持久化：** 支持 Checkpoints，Agent 运行到一半宕机了，重启后能接着跑。
  - **受控性：** 开发者可以定义强制性的 SOP（标准作业程序）流程。
- **适用场景：** 需要“自主 Debug”、“多轮审核”或“长时间运行”的复杂系统。
- ReAct Agent (推理核心：自主决策)

- **核心定义：** Reasoning + Acting（推理 + 行动）模式。
- **理解：** 这是最经典的 Agent 模板。它解决了“模型只会说，不会做”的问题。
- **工作流：** 模型接收问题 -> 思考（Thought） -> 决定调哪个工具（Action） -> 获取结果（Observation） -> 循环直到得出结论。
- **适用场景：** 典型的**插件式助手**。如：帮我查一下 Google Calendar，然后发一封邮件。
- Memory Agent (交互核心：长期记忆)

- **核心定义：** 具备跨会话（Session）状态存储能力的智能体。
- **理解：** 传统的 LLM 只有“瞬时记忆”。Memory Agent 引入了外部存储（如 Redis 或 Mem0），能记住用户的偏好、历史习惯和之前讨论过的细节。
- **技术特征：**
  - **实体抽取：** 自动从对话中提取“我喜欢 React”等信息并存入知识图谱。
  - **上下文压缩：** 自动总结长对话，防止超出 Token 限制。
- **适用场景：** 个人 AI 助理、长期陪伴型机器人、需要记住用户技术栈的开发助手。
- Retrieval Agent (知识核心：动态检索)

- **核心定义：** RAG（检索增强生成）专精智能体。
- **理解：** 它的核心任务是“翻书”。当用户提问时，它先去向量数据库（如 Pinecone 或 Milvus）检索最相关的文档片段，再回答。
- **技术特征：**
  - **自适应检索：** 它会先判断是否需要检索（Router）。
  - **重排（Re-rank）：** 对搜到的结果进行二次打分，提高准确率。
- **适用场景：** 企业知识库查询、查阅最新的 API 文档、基于私有代码库的代码问答。
- Data-enrichment Agent (任务核心：数据加工)

- **核心定义：** 结构化数据清洗与增强智能体。
- **理解：** 这类 Agent 的目标是将“非结构化/不完整数据”转变为“高质量、高价值数据”。
- **工作流：** 接收原始信息 -> 搜索外部资料（网页补全） -> 格式化为 JSON -> 校验数据准确性。
- **适用场景：** 自动化线索挖掘（爬取公司官网并总结业务）、财报分析、将杂乱的日志自动转成结构化报告。

------

二、 深度对比与选型矩阵

| 选项                  | 解决的核心痛点         | 关键技术               | 优先级                  |
| :-------------------- | :--------------------- | :--------------------- | :---------------------- |
| **LangGraph Project** | 逻辑失控、不可回溯     | 有向图、Checkpoints    | **最高** (作为顶层框架) |
| **ReAct Agent**       | 无法调用外部工具       | Thought-Action-Obs     | 中 (基础能力)           |
| **Memory Agent**      | 记不住历史，沟通效率低 | Mem0、Vector Store     | 高 (针对个性化应用)     |
| **Retrieval Agent**   | 幻觉严重、知识过时     | RAG、Embedding         | 高 (针对专业领域)       |
| **Data-enrichment**   | 手动处理数据太慢       | JSON Mode、Search Tool | 中 (针对特定任务)       |

------

三、 专家建议：如何组合使用？

在 2026 年的实际开发中，你通常**不只是选择一个**，而是以 **LangGraph** 为底座，将其他几个模板的能力集成进去。

**推荐开发路径：**

1. **第一步：** 创建一个 `New LangGraph Project`。
2. **第二步：** 在图中定义一个 `Node`，其逻辑参考 `Retrieval Agent`（负责拿资料）。
3. **第三步：** 定义另一个 `Node`，逻辑参考 `ReAct Agent`（负责思考怎么用这些资料）。
4. **第四步：** 接入 `Memory` 模块，确保 Agent 下次启动时还记得这次的操作。

**总结：**

- 如果你要**架构控制力**，选 1。
- 如果你要**调用 API**，选 2。
- 如果你要**个性化**，选 3。
- 如果你要**解决幻觉**，选 4。
- 如果你要**自动化办公**，选 5。